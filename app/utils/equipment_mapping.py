"""
设备名称到编号映射模块
"""

# 设备类别和预定义名称的编号映射
EQUIPMENT_TYPE_MAPPING = {
    # 温度环境类 TEM
    'TEM': {
        '温湿度计': '1',
        '玻璃液体温度计': '2',
        '温湿度表': '3',
        '标准水银温度计': '4',
        '工作用玻璃温度计': '5',
        '迷你温湿度计': '6',
        '数显温度计': '7',
        '标准水槽': '8',
        '标准油槽': '9',
        '标准铂电阻温度计': '10'
    },
    # 长度/几何量类 DIM
    'DIM': {
        '钢直尺': '1',
        '外径千分尺': '2',
        '游标卡尺': '3',
        '杠杆千分尺': '4',
        '钢卷尺': '5',
        '深度千分尺': '6',
        '刀口尺': '7',
        '刀口直角尺': '8',
        '高度游标卡尺': '9',
        '塞尺': '10',
        '数显千分尺': '11',
        '数显卡尺': '12',
        '深度游标卡尺': '13',
        '条式水平仪': '14',
        '内径百分表': '15',
        '磁性位移测量仪': '16',
        '立式光学计': '17',
        '百分表': '18',
        '表面粗糙度比较样块': '19'
    },
    # 质量称量类 MAS
    'MAS': {
        '电子台秤': '1',
        'M1级砝码': '2',
        '工业天平': '3',
        '电子天平': '4',
        '电子计数秤': '5',
        '防爆电子秤': '6',
        '数字式电子汽车衡': '7',
        '砝码': '8'
    },
    # 时间测量类 TIM
    'TIM': {
        '电子秒表': '1'
    },
    # 容量测量类 VOL
    'VOL': {
        '分度吸量管': '1',
        '酸式滴定管': '2',
        '碱式滴定管': '3',
        '量杯': '4',
        '量筒': '5',
        '单标线吸量管': '6',
        '酸碱两用聚四氟滴定管': '7',
        '单标线容量瓶': '8',
        '可调移液器': '9',
        '移液枪': '10'
    },
    # 压力测量类 PRE
    'PRE': {
        '乙炔压力表': '1',
        '氧压力表': '2',
        '氢气压力表': '3',
        '氩气压力表': '4',
        '氮气压力表': '5',
        '氦气压力表': '6',
        '压力表': '7',
        '抗震压力表': '8',
        '耐震压力表': '9',
        '精密真空表': '10',
        '精密压力表': '11',
        '数字式差压计': '12'
    },
    # 电学测试类 ELE
    'ELE': {
        '耐压测试仪': '1',
        '绝缘电阻表': '2',
        '数字多用表': '3',
        'MT500P多路温度记录仪': '4',
        '高绝缘电阻测试仪': '5',
        '旋转式直流电阻箱': '6',
        '转换开关': '7',
        '表面电阻测试仪': '8'
    },
    # 光学测试类 OPT
    'OPT': {
        '色差仪': '1',
        '白度仪': '2',
        '标准光源对色灯箱': '3',
        '目视比色箱': '4',
        '黑白格玻璃板': '5',
        '铁钴比色计': '6',
        '光泽度仪': '7',
        '阿贝折射仪': '8',
        '反射率测定仪': '9'
    },
    # 环境试验类 CLT
    'CLT': {
        '氙灯老化试验箱': '1',
        '紫外老化试验箱': '2',
        '盐雾试验机': '3',
        '高低温交变湿热实验箱': '4',
        '紫外综合试验箱': '5'
    },
    # 化学分析类 CHE
    'CHE': {
        '气相色谱仪': '1',
        '紫外可见分光光度计': '2',
        '紫外分光光度计': '3',
        '原子吸收分光光度计': '4',
        'ICP发射光谱仪': '5',
        '凝胶色谱仪': '6',
        '化学需氧量（COD）快速测定仪': '7',
        '水分测试仪': '8',
        '自动快速平衡法微量闪点测试仪': '9',
        '笔试PH计': '10',
        '微量水分测定仪': '11',
        'PH计': '12'
    },
    # 涂层检测类 COA
    'COA': {
        '铅笔硬度计': '1',
        '数显卡规式测厚仪': '2',
        '磁性测厚仪': '3',
        '百格板': '4',
        '漆膜划格器': '5',
        '漆膜柔韧性测定仪': '6',
        '漆膜弹性试验仪': '7',
        '干燥时间试验器': '8',
        '漆膜回粘性测定器': '9',
        '杯突实验仪': '10',
        '磨耗仪': '11',
        '建筑涂料耐洗刷仪': '12',
        '流挂仪': '13',
        '漆膜干燥测定仪': '14',
        '摩擦系数仪': '15',
        '涂层测厚仪': '16',
        '厚漆腻子稠度测定仪': '17',
        '比重杯': '18',
        '摆杆式硬度试验计': '19',
        '附着力测试仪': '20',
        '简支梁冲击试验机': '21',
        '微机控制电子万能试验机': '22',
        '颗粒强度测定仪': '23',
        '汽车密封条磨耗试验机': '24'
    },
    # 粘度流变类 VIS
    'VIS': {
        'ISO流出杯': '1',
        '涂-1#粘度杯': '2',
        '涂-4#粘度杯': '3',
        '斯托默粘度计': '4',
        '旋转粘度计': '5',
        '数字式粘度计': '6',
        '粘度杯': '7'
    },
    # 流量测量类 FLM
    'FLM': {
        '罗茨流量计': '1',
        '腰轮流量计': '2',
        '齿轮流量计': '3',
        '智能浮子流量计': '4'
    },
    # 样品制备类 SAM
    'SAM': {
        '湿膜制备器': '1',
        '涂膜器': '2',
        '漆膜制备器': '3',
        '腻子涂刮器': '4',
        '可调式制备器（数显式）': '5'
    }
}

def get_equipment_type_code(category_code: str, equipment_name: str) -> str:
    """
    根据类别代码和设备名称获取设备类型编号
    """
    if category_code in EQUIPMENT_TYPE_MAPPING:
        category_mapping = EQUIPMENT_TYPE_MAPPING[category_code]
        if equipment_name in category_mapping:
            return category_mapping[equipment_name]
    
    # 如果没有找到映射，生成默认编号
    return f"{category_code}-99"

def get_equipment_sequence_number(category_code: str, equipment_name: str) -> str:
    """
    根据类别代码和设备名称获取设备类型序列号
    格式: TEM-1 -> 1
    """
    type_code = get_equipment_type_code(category_code, equipment_name)
    if '-' in type_code:
        return type_code.split('-')[1]
    return "99"

def get_equipment_sequence_from_type_code(type_code: str) -> str:
    """
    从设备类型编号中提取序列号
    格式: TEM-1 -> 1
    """
    if '-' in type_code:
        return type_code.split('-')[1]
    return "99"