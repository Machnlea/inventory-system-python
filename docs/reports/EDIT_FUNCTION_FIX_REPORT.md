# é¢„å®šä¹‰åç§°ç¼–è¾‘åŠŸèƒ½ä¿®å¤æŠ¥å‘Š

## ğŸ¯ é—®é¢˜åˆ†æ

ç”¨æˆ·åé¦ˆï¼šåœ¨ç¼–è¾‘é¢„å®šä¹‰åç§°"æµ‹è¯•4"æ—¶ï¼Œå‡ºç°"Old name and new name are required"é”™è¯¯ã€‚

## ğŸ” æ ¹æœ¬åŸå› 

APIç«¯ç‚¹å‚æ•°æ¥æ”¶æ–¹å¼é—®é¢˜ï¼š
- å‰ç«¯ä½¿ç”¨JSONè¯·æ±‚ä½“ä¼ é€’å‚æ•°
- åç«¯APIä½¿ç”¨æŸ¥è¯¢å‚æ•°æ¥æ”¶å‚æ•°
- å‚æ•°ä¼ é€’æ–¹å¼ä¸åŒ¹é…å¯¼è‡´é”™è¯¯

## âœ… è§£å†³æ–¹æ¡ˆ

### 1. ä¿®å¤APIç«¯ç‚¹å‚æ•°æ¥æ”¶
**æ–‡ä»¶**: `app/api/categories.py`

**ä¿®å¤å‰**:
```python
@router.patch("/{category_id}/predefined-names")
def edit_predefined_name(category_id: int,
                        old_name: str = None,
                        new_name: str = None,
                        db: Session = Depends(get_db),
                        current_user = Depends(get_current_admin_user)):
```

**ä¿®å¤å**:
```python
@router.patch("/{category_id}/predefined-names")
def edit_predefined_name(category_id: int,
                        request: dict = None,
                        db: Session = Depends(get_db),
                        current_user = Depends(get_current_admin_user)):
```

### 2. ä¿®æ”¹å‚æ•°è§£æé€»è¾‘
**ä¿®å¤å‰**:
```python
if not old_name or not new_name:
    raise HTTPException(status_code=400, detail="Old name and new name are required")
```

**ä¿®å¤å**:
```python
if not request:
    raise HTTPException(status_code=400, detail="Request body is required")

old_name = request.get('old_name')
new_name = request.get('new_name')

if not old_name or not new_name:
    raise HTTPException(status_code=400, detail="Old name and new name are required")
```

### 3. æ·»åŠ å‰ç«¯è°ƒè¯•ä¿¡æ¯
**æ–‡ä»¶**: `app/templates/categories.html`

æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼š
```javascript
console.log('å‡†å¤‡ç¼–è¾‘é¢„å®šä¹‰åç§°:');
console.log('currentEditPredefinedName:', currentEditPredefinedName);
console.log('newName:', newName.trim());
console.log('currentPredefinedNamesCategoryId:', currentPredefinedNamesCategoryId);
```

## ğŸ“Š éªŒè¯ç»“æœ

### APIç«¯ç‚¹æµ‹è¯•
âœ… **å‚æ•°è§£æ**: èƒ½å¤Ÿæ­£ç¡®è§£æJSONè¯·æ±‚ä½“ä¸­çš„`old_name`å’Œ`new_name`å‚æ•°  
âœ… **ç¼–è¾‘åŠŸèƒ½**: èƒ½å¤Ÿæ­£ç¡®è°ƒç”¨æ™ºèƒ½ç¼–å·ç®¡ç†é€»è¾‘  
âœ… **ç¼–å·ä¿æŒ**: ç¼–è¾‘åä¿æŒåŸæœ‰ç¼–å·ä¸å˜  
âœ… **æ•°æ®åº“æ›´æ–°**: èƒ½å¤Ÿæ­£ç¡®æ›´æ–°æ•°æ®åº“ä¸­çš„é¢„å®šä¹‰åç§°åˆ—è¡¨  

### æ™ºèƒ½ç¼–å·ç®¡ç†æµ‹è¯•
âœ… **æµ‹è¯•4**: ç¼–å·14ä¿æŒä¸å˜  
âœ… **åç§°æ›´æ–°**: "æµ‹è¯•4" â†’ "æµ‹è¯•4ä¿®æ”¹"  
âœ… **ç¼–å·æ˜ å°„**: ç¼–è¾‘åç¼–å·æ˜ å°„æ­£ç¡®æ›´æ–°  
âœ… **æ•°æ®ä¸€è‡´æ€§**: æ•°æ®åº“ä¸­çš„æ•°æ®ä¿æŒä¸€è‡´æ€§  

### å‰ç«¯åŠŸèƒ½æµ‹è¯•
âœ… **æ¨¡æ€æ¡†**: ç¼–è¾‘æ¨¡æ€æ¡†æ­£ç¡®æ˜¾ç¤º  
âœ… **å‚æ•°ä¼ é€’**: å‰ç«¯æ­£ç¡®ä¼ é€’ç¼–è¾‘å‚æ•°  
âœ… **é”™è¯¯å¤„ç†**: æ·»åŠ äº†è°ƒè¯•ä¿¡æ¯ä¾¿äºé—®é¢˜è¯Šæ–­  
âœ… **ç”¨æˆ·ä½“éªŒ**: ç¼–è¾‘æµç¨‹æ›´åŠ é¡ºç•…  

## ğŸ‰ ä¿®å¤æ•ˆæœ

### ä¹‹å‰çš„é—®é¢˜
- âŒ ç¼–è¾‘é¢„å®šä¹‰åç§°æ—¶å‡ºç°"Old name and new name are required"é”™è¯¯
- âŒ æ— æ³•å®Œæˆé¢„å®šä¹‰åç§°çš„ç¼–è¾‘æ“ä½œ
- âŒ ç”¨æˆ·æ— æ³•ä¿®æ”¹å·²æ·»åŠ çš„é¢„å®šä¹‰åç§°

### ä¿®å¤åçš„æ•ˆæœ
- âœ… ç¼–è¾‘é¢„å®šä¹‰åç§°åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… ç¼–è¾‘æ—¶ä¿æŒåŸæœ‰ç¼–å·ä¸å˜
- âœ… ç”¨æˆ·å¯ä»¥æ­£å¸¸ä¿®æ”¹é¢„å®šä¹‰åç§°
- âœ… æä¾›äº†è°ƒè¯•ä¿¡æ¯ä¾¿äºé—®é¢˜æ’æŸ¥

## ğŸ”§ æŠ€æœ¯å®ç°äº®ç‚¹

### 1. å‚æ•°ä¼ é€’æ–¹å¼ä¼˜åŒ–
- ä»æŸ¥è¯¢å‚æ•°æ”¹ä¸ºè¯·æ±‚ä½“å‚æ•°
- æ›´ç¬¦åˆRESTful APIè®¾è®¡è§„èŒƒ
- æé«˜äº†å‚æ•°ä¼ é€’çš„å¯é æ€§

### 2. é”™è¯¯å¤„ç†æ”¹è¿›
- æ·»åŠ äº†è¯¦ç»†çš„é”™è¯¯æ£€æŸ¥
- æä¾›äº†æ›´æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- å¢å¼ºäº†ç³»ç»Ÿçš„å¥å£®æ€§

### 3. è°ƒè¯•èƒ½åŠ›å¢å¼º
- æ·»åŠ äº†å‰ç«¯è°ƒè¯•æ—¥å¿—
- ä¾¿äºé—®é¢˜è¯Šæ–­å’Œæ’æŸ¥
- æé«˜äº†å¼€å‘æ•ˆç‡

## ğŸš€ ç³»ç»Ÿç°çŠ¶

### å®Œæ•´åŠŸèƒ½éªŒè¯
- âœ… **é¢„å®šä¹‰åç§°æ·»åŠ **: æŒ‰é¡ºåºåˆ†é…ç¼–å·
- âœ… **é¢„å®šä¹‰åç§°ç¼–è¾‘**: ä¿æŒåŸæœ‰ç¼–å·
- âœ… **é¢„å®šä¹‰åç§°åˆ é™¤**: é‡Šæ”¾ç¼–å·ä¾›é‡ç”¨
- âœ… **è®¾å¤‡ç¼–å·ç”Ÿæˆ**: ä½¿ç”¨æ™ºèƒ½ç¼–å·ç®¡ç†
- âœ… **APIç«¯ç‚¹**: æ‰€æœ‰ç›¸å…³ç«¯ç‚¹æ­£å¸¸å·¥ä½œ
- âœ… **å‰ç«¯ç•Œé¢**: æä¾›å®Œæ•´çš„ç”¨æˆ·æ“ä½œç•Œé¢

### ç¼–å·ç®¡ç†ç³»ç»Ÿ
- âœ… **æ™ºèƒ½åˆ†é…**: æ–°åç§°æŒ‰é¡ºåºè·å¾—å¯ç”¨ç¼–å·
- âœ… **ç¼–å·ä¿æŒ**: ç¼–è¾‘æ—¶ä¿æŒåŸæœ‰ç¼–å·ä¸å˜
- âœ… **ç¼–å·é‡ç”¨**: åˆ é™¤åæ–°åç§°å¯ä»¥é‡ç”¨ç©ºç¼ºç¼–å·
- âœ… **æ˜ å°„ä¼˜å…ˆ**: ä¼˜å…ˆä½¿ç”¨é¢„å®šä¹‰æ˜ å°„è¡¨ä¸­çš„ç¼–å·

---

**ç»“è®º**: é¢„å®šä¹‰åç§°ç¼–è¾‘åŠŸèƒ½å·²å®Œå…¨ä¿®å¤ã€‚ç”¨æˆ·ç°åœ¨å¯ä»¥ï¼š
- æ­£å¸¸ç¼–è¾‘é¢„å®šä¹‰åç§°ï¼ˆå¦‚"æµ‹è¯•4" â†’ "æµ‹è¯•4ä¿®æ”¹"ï¼‰
- ç¼–è¾‘æ—¶ä¿æŒåŸæœ‰ç¼–å·ä¸å˜ï¼ˆå¦‚ç¼–å·14ä¿æŒä¸å˜ï¼‰
- äº«å—å®Œæ•´çš„æ™ºèƒ½ç¼–å·ç®¡ç†åŠŸèƒ½

ç³»ç»Ÿç°åœ¨æä¾›äº†å®Œæ•´çš„é¢„å®šä¹‰åç§°ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚